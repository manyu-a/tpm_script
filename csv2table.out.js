const style=document.createElement("style");style.textContent="\n#overlay {\nposition: fixed;\ntop: 50%;\nleft: 50%;\ntransform: translate(-50%, -50%);\nwidth: 400px;\nheight: 280px;\nbackground-color: rgba(0, 0, 0, 0.9);\nz-index: 9999;\nborder-radius: 15px;\ndisplay: flex;\nflex-direction: column;\njustify-content: center;\nalign-items: center;\ncolor: white;\nbox-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n}\n#overlay button, #overlay .close, #overlay textarea {\nmargin: 10px;\npadding: 10px;\nfont-size: 16px;\nborder-radius: 5px;\n}\n#overlay button {\nbackground-color: #4CAF50;\ncolor: white;\nborder: none;\ncursor: pointer;\n}\n#overlay button:hover {\nbackground-color: #45a049;\n}\n#overlay .button-container {\ndisplay: flex;\nflex-direction: row;\njustify-content: center;\ngap: 10px; /* \u30dc\u30bf\u30f3\u9593\u306e\u9699\u9593 */\nwidth: 100%; /* \u6a2a\u5e45\u3044\u3063\u3071\u3044\u306b */\n}\n#overlay .close {\nposition: absolute;\ntop: 10px;\nright: 10px;\nbackground-color: #f44336;\ncolor: white;\nborder: none;\n}\n#overlay .close:hover {\nbackground-color: #d32f2f;\n}\n#overlay textarea {\nwidth: 90%;\nheight: 60px;\nborder: 1px solid #ccc;\nbackground-color: #333;\ncolor: white;\n}\n";
document.head.appendChild(style);
function showCopyDialog(e){return new Promise(l=>{const g=document.createElement("style");g.textContent="\n#custom-dialog {\nposition: fixed;\ntop: 50%;\nleft: 50%;\ntransform: translate(-50%, -50%);\nwidth: 340px;\nbackground: rgba(0, 0, 0, 0.9);\nborder-radius: 10px;\nbox-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\npadding: 20px;\nz-index: 10000;\ncolor: #333;\n}\n#custom-dialog textarea {\nwidth: 100%;\nheight: 150px;\nmargin-bottom: 10px;\nbackground-color: #333;\ncolor: white;\nfont-size: 14px;\n}\n#custom-dialog .button-container {\ndisplay: flex;\njustify-content: space-around;\nalign-items: stretch; \ngap: 10px;\n}\n#custom-dialog button {\nmargin: 10px;\npadding: 10px 20px;\nfont-size: 14px;\nbackground-color: #4CAF50;\ncolor: white;\nborder: none;\nborder-radius: 5px;\ncursor: pointer;\n}\n#custom-dialog button:hover {\nbackground-color: #45a049;\n}\n";document.head.appendChild(g);
const d=document.createElement("div");d.id="custom-dialog";const f=document.createElement("textarea");f.value=e;const k=document.createElement("button");k.textContent="OK";k.onclick=()=>{document.body.removeChild(d);document.head.removeChild(g);l()};const m=document.createElement("button");m.textContent="\u30b3\u30d4\u30fc";m.onclick=()=>{const n=f.value;if(navigator.clipboard)navigator.clipboard.writeText(n).then(()=>{showToast("\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f")}).catch(c=>
{showToast("\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u306e\u30b3\u30d4\u30fc\u306b\u5931\u6557\u3057\u307e\u3057\u305f: "+c.message)});else{const c=document.createElement("textarea");c.value=n;document.body.appendChild(c);c.select();document.execCommand("copy");document.body.removeChild(c);showToast("\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f")}};d.appendChild(f);const p=document.createElement("div");p.className="button-container";p.appendChild(k);
p.appendChild(m);d.appendChild(p);document.body.appendChild(d)})}
function showToast(e,l=3E3){const g=document.createElement("style");g.textContent="\n#toast {\nposition: fixed;\nbottom: -100px; /* \u521d\u671f\u4f4d\u7f6e\u306f\u753b\u9762\u5916 */\nleft: 50%;\ntransform: translateX(-50%);\nbackground-color: #333;\ncolor: white;\npadding: 15px 20px;\nborder-radius: 10px;\nbox-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\nfont-size: 14px;\nopacity: 0;\ntransition: all 0.5s ease; /* \u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u52b9\u679c */\nz-index: 10000;\n}\n#toast.show {\nbottom: 30px; /* \u8868\u793a\u4f4d\u7f6e */\nopacity: 1;   /* \u8868\u793a\u72b6\u614b */\n}\n";document.head.appendChild(g);
const d=document.createElement("div");d.id="toast";d.textContent=e;document.body.appendChild(d);setTimeout(()=>{d.classList.add("show")},100);setTimeout(()=>{d.classList.remove("show");setTimeout(()=>{document.body.removeChild(d);document.head.removeChild(g)},500)},l)}const clearTypeColors={"NO PLAY":"transparent",FAILED:"#808080","EASY CLEAR":"#00FF00","ASSIST CLEAR":"#800080",CLEAR:"#0000FF","HARD CLEAR":"#FF0000","EX HARD CLEAR":"#FFFF00","FULLCOMBO CLEAR":"#FFA500"},overlay=document.createElement("div");
overlay.id="overlay";const close=document.createElement("button");close.className="close";close.textContent="\u00d7";close.onclick=function(){document.body.removeChild(overlay)};const textarea=document.createElement("textarea");textarea.placeholder="CSV\u30c7\u30fc\u30bf\u3092\u8cbc\u308a\u4ed8\u3051\u3066\u304f\u3060\u3055\u3044";const storedCsvKey="savedCsvData",saveButton=document.createElement("button");saveButton.textContent="\u4fdd\u5b58";
saveButton.onclick=function(){const e=textarea.value.trim();e?(localStorage.setItem(storedCsvKey,e),showToast("CSV\u30c7\u30fc\u30bf\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f")):showToast("\u4fdd\u5b58\u3059\u308bCSV\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093")};const restoreButton=document.createElement("button");restoreButton.textContent="\u5fa9\u5143";
restoreButton.onclick=function(){try{const e=localStorage.getItem(storedCsvKey);e?(textarea.value=e,showToast("CSV\u30c7\u30fc\u30bf\u3092\u5fa9\u5143\u3057\u307e\u3057\u305f")):showToast("\u5fa9\u5143\u3059\u308bCSV\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093")}catch(e){showToast("\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f: "+e.message)}};const old_savedData=localStorage.getItem(storedCsvKey),diffButton=document.createElement("button");diffButton.textContent="\u5dee\u5206\u8868\u793a";
diffButton.onclick=function(){function e(c){return c.split("\n").slice(1).map(b=>{b=b.split(",");return{title:b[1],blamp:b[10],nlamp:b[17],hlamp:b[24],alamp:b[31],llamp:b[38],bscore:parseInt(b[6],10),nscore:parseInt(b[13],10),hscore:parseInt(b[20],10),ascore:parseInt(b[27],10),lscore:parseInt(b[34],10),blevel:parseInt(b[5],10),nlevel:parseInt(b[12],10),hlevel:parseInt(b[19],10),alevel:parseInt(b[26],10),llevel:parseInt(b[33],10)}})}let l="";l=null!==old_savedData?old_savedData:localStorage.getItem(storedCsvKey);
const g=textarea.value.trim();if(l&&g){var d=["blamp","nlamp","hlamp","alamp","llamp"],f=["bscore","nscore","hscore","ascore","lscore"],k=e(l),m=[],p=[],n={"ASSIST CLEAR":"\u8db3","EASY CLEAR":"\u6613",CLEAR:"\u30ce\u30de\u30b2","HARD CLEAR":"\u30cf\u30fc\u30c9","EX HARD CLEAR":"\u30a8\u30af\u30cf","FULLCOMBO CLEAR":"\u30d5\u30eb\u30b3\u30f3"};e(g).forEach(c=>{let b=k.find(a=>a.title===c.title);b||={blamp:"NO PLAY",nlamp:"NO PLAY",hlamp:"NO PLAY",alamp:"NO PLAY"};b&&(d.forEach(a=>{if(c[a]!==b[a]&&
void 0!==n[c[a]]){const h="alamp"===a?"":`(${a.toUpperCase()[0]})`;m.push([`\u2606${c[a[0]+"level"]}${n[c[a]]}`,`${c.title}${h}`,c[a[0]+"level"]])}}),f.forEach(a=>{if(c[a]!==b[a]){const h="alamp"===a?"":`(${a.toUpperCase()[0]})`;p.push([`\u2606${c[a[0]+"level"]}`,`${c.title}${h} \u30b9\u30b3\u30a2: ${b[a]} \u2192 ${c[a]}`,c[a[0]+"level"]])}}))});if(0<m.length){let c="";m.sort((a,h)=>a[2]<h[2]?-1:a[2]>h[2]?1:0);const b=m.reduce((a,h)=>{a[h[0]]||(a[h[0]]=[]);a[h[0]].push(h[1]);return a},{});Object.keys(b).forEach(a=>
{const h=b[a].map(q=>`${q}`).join("\n");c+=`\n\n${a}\n${h}`});showCopyDialog("\u30e9\u30f3\u30d7\u306e\u5dee\u5206:"+c)}else showToast("\u30e9\u30f3\u30d7\u306e\u5dee\u5206\u306f\u3042\u308a\u307e\u305b\u3093")}else showToast("\u4fdd\u5b58\u3055\u308c\u305f\u30c7\u30fc\u30bf\u307e\u305f\u306f\u73fe\u5728\u306e\u30c7\u30fc\u30bf\u304c\u3042\u308a\u307e\u305b\u3093")};const loadButton=document.createElement("button");loadButton.textContent="\u8272\u4ed8\u3051";
loadButton.onclick=function(){try{const g=textarea.value.trim();if(g){var e=document.querySelectorAll("table tr"),l=g.split("\n").slice(1).map(d=>{var f=d.split(",");const k=f[1];d=parseInt(f[19],10);const m=parseInt(f[26],10),p=parseInt(f[33],10),n=f[24],c=f[31],b=f[38];f=[];11===d&&(e.forEach(a=>{a.querySelector("td:nth-child(2)").innerText.trim()===k+"(H)"&&(a.style.backgroundColor=clearTypeColors[n])}),f.push({title:k,difficulty:"(H)",ClearType:n}));11===m&&(e.forEach(a=>{a.querySelector("td:nth-child(2)").innerText.trim()===
k&&(a.style.backgroundColor=clearTypeColors[c])}),f.push({title:k,difficulty:"(A)",ClearType:c}));11===p&&(e.forEach(a=>{a.querySelector("td:nth-child(2)").innerText.trim()===k+"(L)"&&(a.style.backgroundColor=clearTypeColors[b])}),f.push({title:k,difficulty:"(A)",ClearType:b}));return f}).filter(d=>0!==d.length);console.log(l);0<l.length?showToast(`${l.length}\u66f2\u3092\u5857\u308a\u307e\u3057\u305f`):showToast("\u6761\u4ef6\u306b\u8a72\u5f53\u3059\u308b\u66f2\u304c\u3042\u308a\u307e\u305b\u3093")}else showToast("CSV\u304c\u7a7a\u3067\u3059")}catch(g){showToast("CSV\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f: "+
g.message)}};overlay.appendChild(close);overlay.appendChild(textarea);const buttonContainer=document.createElement("div");buttonContainer.className="button-container";buttonContainer.appendChild(loadButton);buttonContainer.appendChild(saveButton);buttonContainer.appendChild(restoreButton);buttonContainer.appendChild(diffButton);overlay.appendChild(buttonContainer);document.body.appendChild(overlay);
